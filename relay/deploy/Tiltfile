load('ext://restart_process', 'docker_build_with_restart')

k8s_yaml("relay.yaml")

docker_build_with_restart(
    "relay",
    context="../..",
    dockerfile="relay.dockerfile",
    build_args={"RELAY_HOST": "0.0.0.0", "RELAY_PORT": "2700","RELAY_LOG_LEVEL": "DEBUG"},
    ignore=["**/.*", "**/__pycache__", "functional_tests", "cli"],
    live_update=[
        sync("../..", "/app/python-ndk"),
    ],
    entrypoint="python /app/python-ndk/relay/server.py"
)